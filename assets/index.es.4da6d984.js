import{j as e,a as t,c as l,k as o,l as a,u as i,p as n,q as s,i as d,t as r,v as u,x as p,b as c,g as m,y,z as v,A as g,e as f,B as h,C as w,m as T,w as b,T as V,d as S,D as x,F as P,E as k,G as B,H as C,I as _}from"./app.d2ec6c09.js";var z=Object.defineProperty,I=Object.defineProperties,O=Object.getOwnPropertyDescriptors,$=Object.getOwnPropertySymbols,M=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable,D=(e,t,l)=>t in e?z(e,t,{enumerable:!0,configurable:!0,writable:!0,value:l}):e[t]=l,A=(e,t)=>{for(var l in t||(t={}))M.call(t,l)&&D(e,l,t[l]);if($)for(var l of $(t))R.call(t,l)&&D(e,l,t[l]);return e},F=(e,t)=>I(e,O(t));function E(e,t,l,o){var a,i=!1,n=0;function s(){a&&clearTimeout(a)}function d(){for(var d=arguments.length,r=new Array(d),u=0;u<d;u++)r[u]=arguments[u];var p=this,c=Date.now()-n;function m(){n=Date.now(),l.apply(p,r)}function y(){a=void 0}i||(o&&!a&&m(),s(),void 0===o&&c>e?m():!0!==t&&(a=setTimeout(o?y:m,void 0===o?e-c:e)))}return"boolean"!=typeof t&&(o=l,l=t,t=void 0),d.cancel=function(){s(),i=!0},d}function j(e,t,l){return void 0===l?E(e,t,!1):E(e,l,!1!==t)}const L=Object.assign({name:"d-icon"},{props:{icon:String,size:[Number,String]},setup:function(n){const s=n,d=e((()=>({fontSize:/^\d+$/.test(s.size)?s.size+"px":s.size})));return(e,s)=>(t(),l("i",{class:o(["d-icon iconfont",n.icon]),style:a(i(d))},null,6))}});L.__scopeId="data-v-329d18e3",n("data-v-1ad4792d");const H={class:"d-player-top"},N={class:"top-title"},q={class:"top-title"};s();const U={props:{title:{default:""}},setup(e){Date.prototype.format=function(e){let t={"h+":this.getHours(),"m+":this.getMinutes(),"s+":this.getSeconds()};for(var l in t)new RegExp("("+l+")").test(e)&&(e=e.replace(RegExp.$1,1==RegExp.$1.length?t[l]:("00"+t[l]).substr((""+t[l]).length)));return e};let o=g("00:00:00");o.value=(new Date).format("hh:mm:ss");let a=null;return a=setInterval((()=>{o.value=(new Date).format("hh:mm:ss")}),1e3),B((()=>{clearInterval(a)})),(a,n)=>(t(),l("div",H,[c("p",N,y(e.title||""),1),c("p",q,y(i(o)),1)]))},__scopeId:"data-v-1ad4792d"};n("data-v-306c9ef4");const W={class:"d-status"},X={class:"d-status-info"},K={class:"d-status-info"},G=d("5X速播放中 ");s();var Y=r({props:["state"],setup:e=>(o,a)=>u((t(),l("div",W,[u(c("li",X,[m(L,{size:"18",class:"d-status-icon",icon:"icon-volume-"+(0==e.state.volume?"mute":e.state.volume>.5?"up":"down")},null,8,["icon"]),d(" "+y(~~(100*e.state.volume))+"% ",1)],512),[[p,"volume"==e.state.handleType]]),u(c("li",K,[m(L,{size:"12",icon:"icon-play"}),m(L,{size:"12",icon:"icon-play",style:{"margin-right":"5px"}}),G],512),[[p,"playbackRate"==e.state.handleType||e.state.isMultiplesPlay]])],512)),[[p,e.state.handleType||e.state.isMultiplesPlay]])});Y.__scopeId="data-v-306c9ef4",n("data-v-19d1df18");const J=["checked","true-value","false-value"],Q=c("span",{class:"d-switch_action"},null,-1);s();var Z=r({props:{modelValue:{type:[Number,String,Boolean]},width:{type:String,default:"40px"},trueValue:{type:[Number,String,Boolean],default:!0},falseValue:{type:[Number,String,Boolean],default:!0},activeColor:{type:[String],default:"#409EFF"}},emits:["update:modelValue","change"],setup(a,{emit:n}){const s=a;v((e=>({"778bc432":a.width,"4aa16d2e":a.activeColor})));const d=g(null),r=e((()=>s.modelValue===s.trueValue)),u=()=>{w((()=>{const e=d.value.checked;n("update:modelValue",e),n("change",e)}))};return(e,n)=>(t(),l("div",{class:o(["d-switch",{"is-checked":i(r)}])},[c("input",{class:"d-switch__input",ref:d,type:"checkbox",checked:i(r),onChange:u,"true-value":a.trueValue,"false-value":a.falseValue},null,40,J),Q],2))}});Z.__scopeId="data-v-19d1df18",n("data-v-e0a1c384");const ee={key:0},te=c("p",null,"正在缓冲...",-1),le=d("重新播放 "),oe=d("请求错误 ");s();var ae=r({props:{loadType:String,text:{type:String,default:""}},setup(o){const n=o,{proxy:s}=_(),d=()=>{s.$parent.play()},r=e((()=>{let e="background: rgba(0, 0, 0, .1);z-index:1";return"init"==n.loadType&&(e="background: rgba(0, 0, 0, 1);;z-index:3"),e}));return(e,n)=>u((t(),l("div",{class:"d-loading",style:a(i(r))},[c("div",null,["init"==o.loadType?(t(),l("span",ee,[m(L,{class:"rotating",icon:"icon-loading",size:50}),c("p",null,y(o.text),1)])):f("",!0),u(c("span",null,[m(L,{class:"rotating",icon:"icon-loading",size:50}),te],512),[[p,"buffer"==o.loadType]]),u(c("span",null,[c("p",{onClick:d,class:"d-flex-x d-pointer"},[m(L,{icon:"icon-replay",size:24,style:{"mrgin-right":"5px"}}),le])],512),[[p,"ended"==o.loadType]]),u(c("span",null,[c("p",{onClick:d,class:"d-flex-x d-pointer"},[m(L,{icon:"icon-replay",size:24,style:{"mrgin-right":"5px"}}),oe])],512),[[p,"error"==o.loadType||"stalled"==o.loadType]])])],4)),[[p,o.loadType]])}});ae.__scopeId="data-v-e0a1c384";const ie=function(e,t,l,o=!1){e&&t&&l&&e.addEventListener(t,l,o)},ne=function(e,t,l,o=!1){e&&t&&l&&e.removeEventListener(t,l,o)};n("data-v-f2761f54");const se=["onMousedown"];s();var de=r(F(A({},{name:"DSlider"}),{props:{modelValue:{required:!0,type:Number,default:0},disabled:{type:Boolean,default:!1},vertical:{type:Boolean,default:!1},hover:{type:Boolean,default:!0},hoverText:{type:String,default:""},preload:{type:Number,default:0},size:{type:String,default:"10px"}},emits:["update:modelValue","change","onMousemove"],setup(n,{emit:s}){const d=n;v((e=>({"04188216":n.size})));const r=g(null),m=g(null),f=h({dragging:!1,hoverPosition:0,hoverTipsLeft:"50%"}),w=e((()=>{let e=d.modelValue<0?0:d.modelValue>1?1:d.modelValue;return d.vertical?`height:${100*e}%`:`width:${100*e}%`})),T=e((()=>{let e=d.preload<0?0:d.preload>1?1:d.preload;return d.vertical?`height:${100*e}%`:`width:${100*e}%`})),b=e((()=>{let e=f.hoverPosition<0?0:f.hoverPosition>1?1:f.hoverPosition;return d.vertical?`bottom:${100*e}%`:`left:${100*e}%`})),V=e=>{e.preventDefault()},S=e=>{d.disabled||(e.preventDefault(),f.dragging=!0,P(e),ie(window,"mousemove",B),ie(window,"touchmove",B),ie(window,"mouseup",_),ie(window,"touchend",_))},x=e=>{if(!d.hover)return;let t=k(e);if(s("onMousemove",e,t),f.hoverPosition=t,d.vertical)return;let l=r.value,o=m.value.clientWidth/2,a=e.clientX-l.getBoundingClientRect().left;a<o?f.hoverTipsLeft=o-a+"px":l.clientWidth-a<o?f.hoverTipsLeft=l.clientWidth-a-o+"px":f.hoverTipsLeft="50%"},P=e=>{let t=k(e);s("update:modelValue",t),s("change",e,t)},k=e=>{let t=r.value,l=0;if(d.vertical){let o=t.clientHeight;l=(t.getBoundingClientRect().bottom-e.clientY)/o}else l=(e.clientX-t.getBoundingClientRect().left)/t.clientWidth;return l<0?0:l>1?1:l},B=e=>{P(e)},_=e=>{f.dragging&&(ne(window,"mousemove",B),ne(window,"touchmove",B),ne(window,"mouseup",_),ne(window,"touchend",_),ne(window,"contextmenu",_),setTimeout((()=>{f.dragging=!1}),0))};return(e,n)=>(t(),l("div",{ref:r,class:o(["d-slider",{"is-vertical":d.vertical}]),onMousedown:C(S,["stop"]),onContextmenu:V},[c("div",{class:"d-slider__runway",onMousemove:x},[u(c("div",{class:"d-slider__cursor",style:a(i(b))},[u(c("div",{class:"d-slider__tips",ref:m,style:a({left:i(f).hoverTipsLeft})},y(d.hoverText),5),[[p,d.hoverText]])],4),[[p,d.hover]]),c("div",{class:"d-slider__preload",style:a(i(T))},null,4),c("div",{class:"d-slider__bar",style:a(i(w))},null,4)],32)],42,se))}}));de.__scopeId="data-v-f2761f54";const re=e=>{let t=~~(e/3600),l=~~(e%3600/60),o=~~(e%60);return t=t<10?"0"+t:t,l=l<10?"0"+l:l,o=o<10?"0"+o:o,`${t}:${l}:${o}`},ue=!!("ontouchstart"in window),pe={width:{type:String,default:"800px"},height:{type:String,default:"450px"},color:{type:String,default:"#409eff"},webFullScreen:{type:Boolean,default:!1},speed:{type:Boolean,default:!0},playsinline:{type:Boolean,default:!1},muted:{type:Boolean,default:!1},speedRate:{type:Array,default:()=>["2.0","1.0","1.5","1.25","0.75","0.5"]},autoPlay:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},mirror:{type:Boolean,default:!1},ligthOff:{type:Boolean,default:!1},volume:{type:[String,Number],default:.3},control:{type:Boolean,default:!0},title:{type:String,default:""},src:{required:!0,type:String,default:""},preload:{type:String,default:"auto"}};n("data-v-7ee938a1");const ce={class:"d-player-video"},me=["controls","webkit-playsinline","playsinline","volume","muted","loop","preload","src"],ye={class:"d-player-lightoff"},ve={key:1,class:"d-player-state"},ge={class:"d-play-btn"},fe=["onKeyup"],he={class:"d-control-progress"},we={class:"d-tool-bar"},Te={class:"d-tool-item"},be={class:"d-tool-item d-tool-time"},Ve=c("span",{style:{margin:"0 3px"}},"/",-1),Se={class:"total-time"},xe={class:"d-tool-bar"},Pe={class:"d-tool-item",style:{width:"26px"}},ke={class:"d-tool-item-main"},Be={class:"speed-main"},Ce=["onClick"],_e={class:"d-tool-item"},ze={class:"d-tool-item-main volume-box",style:{width:"52px"}},Ie={class:"volume-text-size"},Oe={class:"d-tool-item"},$e={class:"d-tool-item-main"},Me={class:"speed-main"},Re=d(" 镜像画面 "),De=d(" 循环播放 "),Ae=d(" 关灯模式 "),Fe=c("div",{class:"d-tool-item-main"},"画中画",-1),Ee=c("div",{class:"d-tool-item-main"},"网页全屏",-1),je=c("div",{class:"d-tool-item-main"},"全屏",-1);s();var Le=r(F(A({},{name:"vue3VideoPlay"}),{props:pe,emits:["loadstart","playing","error","stalled","waiting","durationchange","progress","canplay","timeupdate","ended","mirrorChange","loopChange","lightOffChange"],setup(e,{expose:a,emit:n}){const s=e;v((e=>({"0c652f86":i(I),"6c0073d9":e.width,"0b81e518":e.height})));let r=g(null),B=g(null),C=g(null),_=g(null);const z=h(F(A({dVideo:null},s),{muted:s.autoPlay,playBtnState:s.autoPlay?"pause":"play",loading:!0,waitingLoading:!1,loadStateType:"",fullScreen:!1,handleType:"",currentTime:"00:00:00",preloadBar:0,totalTime:"00:00:00",isVideoHovering:!0,speedActive:"1.0",playProgress:0,isMultiplesPlay:!1,longPressTimeout:null,progressCursorTime:"00:00:00"})),I=(O=z.color,`${parseInt("0x"+O.slice(1,3))},${parseInt("0x"+O.slice(3,5))},${parseInt("0x"+O.slice(5,7))}`);var O;const $=j(500,(()=>{z.handleType=""})),M=e=>{let t=e.type,l=e.keyCode||e.code;if(37==l||"ArrowLeft"==l){if(!s.speed)return;"keyup"==t&&(z.dVideo.currentTime=z.dVideo.currentTime<10?.1:z.dVideo.currentTime-10,te(z.dVideo))}else if(38==l||"ArrowTop"==l)"keydown"==t&&(z.muted=!1,z.handleType="volume",$(),z.volume=z.volume+.1>1?1:z.volume+.1);else if(39==l||"ArrowRight"==l){if("keyup"==t){if(clearTimeout(z.longPressTimeout),!s.speed&&!z.longPressTimeout)return;z.isMultiplesPlay?(z.dVideo.playbackRate=z.speedActive,z.isMultiplesPlay=!1):(z.dVideo.currentTime=z.dVideo.currentTime+10,te(z.dVideo))}else if("keydown"==t){if(!s.speed)return;z.isMultiplesPlay&&clearTimeout(z.longPressTimeout),z.longPressTimeout=setTimeout((()=>{z.isMultiplesPlay=!0,z.dVideo.playbackRate=5,z.playBtnState="play",z.dVideo.play(),z.handleType="playbackRate",$()}),500)}}else 40!=l&&"ArrowDown"!=l||"keydown"==t&&(e.preventDefault(),z.muted=!1,z.handleType="volume",$(),z.volume=z.volume-.1<0?0:z.volume-.1)},R=()=>{ue||_.value.focus()},D=()=>{z.dVideo.play().catch((()=>{setTimeout((()=>{z.playBtnState="play"}),500)})),z.playBtnState="pause"},E=()=>{z.dVideo.pause(),z.playBtnState="play"},H=()=>{"play"==z.playBtnState||"replay"==z.playBtnState?D():"pause"==z.playBtnState&&E()},N=e=>{n("playing",e)},q=e=>{z.loadStateType="buffer",n("waiting",e)},W=e=>{console.log("error"),z.loadStateType="error",n("error",e)},X=e=>{console.log("网速失速"),z.loadStateType="stalled",n("stalled",e)},K=e=>{z.loadStateType="ended",z.playBtnState="replay",n("ended",e)},G=e=>{z.loadStateType="init",n("loadstart",e),console.log("开始加载")},J=e=>{n("durationchange",e),z.totalTime=re(e.target.duration)},Q=e=>{console.log("缓冲中..."),n("progress",e);let t=e.target.duration,l=e.target.buffered.length,o=e.target.buffered.length&&e.target.buffered.end(l-1);z.preloadBar=o/t},ee=e=>{z.loadStateType="",n("canplay",e),z.autoPlay&&(z.dVideo.play(),z.playBtnState="pause")},te=e=>{n("timeupdate",e);let t=e.duration||e.target.duration||0,l=e.currentTime||e.target.currentTime;z.playProgress=l/t,z.currentTime=re(l)},le=()=>{z.muted=!z.muted,0==z.volume&&(z.volume=.05)},oe=(e,t)=>{let l=z.dVideo.duration||z.dVideo.target.duration;z.dVideo.currentTime=l*t,"play"==z.playBtnState&&(z.dVideo.play(),z.playBtnState="pause")},ie=(e,t)=>{z.progressCursorTime=re(z.dVideo.duration*t)},ne=j(2500,(()=>{z.isVideoHovering=!1})),se=e=>{z.isVideoHovering=!0,ne()},pe=e=>{n("mirrorChange",e,z.dVideo)},Le=e=>{n("loopChange",e,z.dVideo)},He=e=>{n("lightOffChange",e,z.dVideo)};(async()=>{await w(),z.dVideo=B,z.dVideo.load(),R()})();const Ne=()=>{var e;e=z.dVideo,document.pictureInPictureElement?document.exitPictureInPicture().catch((e=>{console.log(e,"Video failed to leave Picture-in-Picture mode.")})):e.requestPictureInPicture().catch((e=>{console.log(e,"Video failed to enter Picture-in-Picture mode.")}))},qe=()=>{(e=>{let t=document;t.webkitIsFullScreen||t.fullscreen?(document.exitFullscreen||t.webkitExitFullScreen).call(t):(e.requestFullscreen||e.webkitRequestFullScreen).call(e)})(r.value),document.webkitIsFullScreen?z.fullScreen=!1:z.fullScreen=!0};return a({play:D,pause:E,togglePlay:H}),(e,a)=>(t(),l("div",{ref:r,class:o(["d-player-wrap",{"web-full-screen":i(z).webFullScreen,"is-lightoff":i(z).lightOff,"d-player-wrap-hover":"pause"==i(z).playBtnState||i(z).isVideoHovering}]),onMousemove:se},[c("div",ce,[c("video",T({ref:B,class:["d-player-video-main",{"video-mirror":i(z).mirror}],controls:!(!i(ue)||!i(z).speed),"webkit-playsinline":s.playsinline,playsinline:s.playsinline},e.$attrs,{onWaiting:q,onError:W,onStalled:X,onPlaying:N,onLoadstart:G,onDurationchange:J,onProgress:Q,onCanplay:ee,onTimeupdate:te,onEnded:K,volume:i(z).volume,muted:i(z).muted,loop:i(z).loop,preload:e.preload,width:"100%",height:"100%",src:s.src,poster:"https://xdlumia.oss-cn-beijing.aliyuncs.com/videos/02.jpg"}),"您的浏览器不支持Video标签。",16,me)]),m(ae,{loadType:i(z).loadStateType},null,8,["loadType"]),m(V,{name:"d-fade-in"},{default:b((()=>[u(c("div",ye,null,512),[[p,i(z).lightOff]])])),_:1}),i(z).fullScreen&&i(z).isVideoHovering?(t(),S(U,{key:0,title:s.title},null,8,["title"])):f("",!0),i(ue)?f("",!0):(t(),l("div",ve,[m(V,{name:"d-scale-out"},{default:b((()=>[u(c("div",ge,[m(L,{icon:"icon-play",size:40})],512),[[p,"play"==i(z).playBtnState]])])),_:1}),m(Y,{state:i(z)},null,8,["state"])])),i(ue)?f("",!0):(t(),l("input",{key:2,type:"input",readonly:"readonly",ref:_,onDblclick:qe,onClick:H,onKeyup:[x(H,["space"]),M],onKeydown:M,class:"d-player-input",maxlength:"0"},null,40,fe)),!i(ue)&&i(z).control?(t(),l("div",{key:3,class:"d-player-control",ref:C},[c("div",he,[m(de,{class:"d-progress-bar",onOnMousemove:ie,onChange:oe,disabled:!i(z).speed,style:{"z-index":"1"},hoverText:i(z).progressCursorTime,modelValue:i(z).playProgress,"onUpdate:modelValue":a[0]||(a[0]=e=>i(z).playProgress=e),preload:i(z).preloadBar},null,8,["disabled","hoverText","modelValue","preload"])]),c("div",{class:"d-control-tool",onClick:R},[c("div",we,[c("div",Te,[m(L,{onClick:H,size:"24",icon:`icon-${i(z).playBtnState}`},null,8,["icon"])]),c("div",be,[c("span",null,y(i(z).currentTime),1),Ve,c("span",Se,y(i(z).totalTime),1)])]),c("div",xe,[c("div",Pe,[d(y("1.0"==i(z).speedActive?"倍速":i(z).speedActive+"X")+" ",1),c("div",ke,[c("ul",Be,[(t(!0),l(P,null,k(i(z).speedRate,(e=>(t(),l("li",{class:o({"speed-active":i(z).speedActive==e}),onClick:t=>{return l=e,z.speedActive=l,void(z.dVideo.playbackRate=l);var l},key:e},y(e)+"X",11,Ce)))),128))])])]),c("div",_e,[c("div",ze,[c("div",{class:o(["volume-main",{"is-muted":i(z).muted}])},[c("span",Ie,y(i(z).muted?0:~~(100*i(z).volume))+"%",1),m(de,{onChange:a[1]||(a[1]=e=>i(z).muted=!1),hover:!1,size:"5px",vertical:!0,modelValue:i(z).volume,"onUpdate:modelValue":a[2]||(a[2]=e=>i(z).volume=e)},null,8,["modelValue"])],2)]),c("span",{onClick:le,style:{display:"flex"}},[m(L,{size:"20",icon:"icon-volume-"+(0==i(z).volume||i(z).muted?"mute":i(z).volume>.5?"up":"down")},null,8,["icon"])])]),c("div",Oe,[m(L,{size:"20",class:"rotateHover",icon:"icon-settings"}),c("div",$e,[c("ul",Me,[c("li",null,[Re,m(Z,{onChange:pe,modelValue:i(z).mirror,"onUpdate:modelValue":a[3]||(a[3]=e=>i(z).mirror=e)},null,8,["modelValue"])]),c("li",null,[De,m(Z,{onChange:Le,modelValue:i(z).loop,"onUpdate:modelValue":a[4]||(a[4]=e=>i(z).loop=e)},null,8,["modelValue"])]),c("li",null,[Ae,m(Z,{onChange:He,modelValue:i(z).lightOff,"onUpdate:modelValue":a[5]||(a[5]=e=>i(z).lightOff=e)},null,8,["modelValue"])])])])]),c("div",{class:"d-tool-item",onClick:Ne},[m(L,{size:"20",icon:"icon-pip"}),Fe]),c("div",{class:"d-tool-item",onClick:a[6]||(a[6]=e=>i(z).webFullScreen=!i(z).webFullScreen)},[m(L,{size:"20",icon:"icon-web-screen"}),Ee]),c("div",{class:"d-tool-item",onClick:qe},[je,m(L,{size:"20",icon:"icon-screen"})])])])],512)):f("",!0)],34))}}));function He(e){e.component(Le.name,Le)}Le.__scopeId="data-v-7ee938a1",Le.install=He;export{Le as default,He as install,Le as videoPlay};
